/* JSZip - Minimal Implementation for Excel Export */
(function() {
  'use strict';
  
  function JSZip() {
    this.files = {};
  }
  
  JSZip.prototype.file = function(name, content) {
    if (content === undefined) {
      return this.files[name];
    }
    this.files[name] = {
      name: name,
      content: content,
      date: new Date()
    };
    return this;
  };
  
  JSZip.prototype.generateAsync = function(options) {
    return new Promise(function(resolve) {
      // Simple CSV export instead of actual ZIP
      var csvContent = '';
      for (var filename in this.files) {
        if (filename.endsWith('.csv')) {
          csvContent = this.files[filename].content;
          break;
        }
      }
      
      // Create blob
      var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      resolve(blob);
    }.bind(this));
  };
  
  // Export
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = JSZip;
  } else {
    window.JSZip = JSZip;
  }
  
})();